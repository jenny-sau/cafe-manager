<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stats - Caf√© Manager</title>

    <!-- Police retro -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/static/css/dashboard.css?v=2">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-container">
            <h2>‚òï CAFE MANAGER</h2>
            <div class="nav-links">
                <a href="/dashboard">DASHBOARD</a>
                <a href="/stock">STOCK</a>
                <a href="/stats" class="active">STATS</a>
                <a href="/logout" class="logout">DECONNEXION</a>
            </div>
        </div>
    </nav>

    <!-- Container principal -->
    <div class="dashboard-container">

        <!-- Infos joueur -->
        <div class="player-info">
            <div class="info-card">
                <div class="icon">üë§</div>
                <div>
                    <p class="label">JOUEUR</p>
                    <p class="value">{{ player.username }}</p>
                </div>
            </div>

            <div class="info-card money">
                <div class="icon">üí∞</div>
                <div>
                    <p class="label">ARGENT ACTUEL</p>
                    <p class="value">{{ player.money }}‚Ç¨</p>
                </div>
            </div>

            <div class="info-card level">
                <div class="icon">‚≠ê</div>
                <div>
                    <p class="label">NIVEAU</p>
                    <p class="value">{{ player.level }}</p>
                </div>
            </div>
        </div>

        <!-- Statistiques -->
        <div class="quick-actions">
            <h3>üìä MES STATISTIQUES</h3>

            <div class="stats-grid">
                <div class="stat-card positive">
                    <div class="stat-icon">üí∞</div>
                    <p class="stat-label">ARGENT GAGNE</p>
                    <p class="stat-value">{{ stats.total_earned }}‚Ç¨</p>
                </div>

                <div class="stat-card negative">
                    <div class="stat-icon">üí∏</div>
                    <p class="stat-label">ARGENT DEPENSE</p>
                    <p class="stat-value">{{ stats.total_spent }}‚Ç¨</p>
                </div>

                <div class="stat-card {% if stats.profit >= 0 %}positive{% else %}negative{% endif %}">
                    <div class="stat-icon">üìà</div>
                    <p class="stat-label">PROFIT NET</p>
                    <p class="stat-value">{{ stats.profit }}‚Ç¨</p>
                </div>

                <div class="stat-card info">
                    <div class="stat-icon">üì¶</div>
                    <p class="stat-label">COMMANDES</p>
                    <p class="stat-value">{{ stats.total_orders }}</p>
                </div>
            </div>
        </div>

    </div>

    <!-- Lecteur audio -->
    <audio id="bg-music" loop>
        <source src="/static/music/lofi-cafe.mp3" type="audio/mpeg">
    </audio>

    <button id="music-toggle">üéµ PLAY</button>

    <script>
        const music = document.getElementById('bg-music');
        const toggleBtn = document.getElementById('music-toggle');
        let isPlaying = false;

        const savedTime = localStorage.getItem('musicTime');
        const savedPlaying = localStorage.getItem('musicPlaying');

        if (savedTime) {
            music.currentTime = parseFloat(savedTime);
        }

        if (savedPlaying === 'true') {
            music.play().then(() => {
                isPlaying = true;
                toggleBtn.textContent = 'üîá PAUSE';
            }).catch(() => {});
        }

        setInterval(() => {
            if (isPlaying) {
                localStorage.setItem('musicTime', music.currentTime);
            }
        }, 1000);

        toggleBtn.addEventListener('click', () => {
            if (isPlaying) {
                music.pause();
                isPlaying = false;
                toggleBtn.textContent = 'üéµ PLAY';
                localStorage.setItem('musicPlaying', 'false');
            } else {
                music.play();
                isPlaying = true;
                toggleBtn.textContent = 'üîá PAUSE';
                localStorage.setItem('musicPlaying', 'true');
            }
        });
    </script>

</body>
</html>